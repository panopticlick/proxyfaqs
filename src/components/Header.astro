---
const navLinks = [
  { href: '/q', label: 'Questions' },
  { href: '/category', label: 'Categories' },
  { href: '/use-cases', label: 'Use Cases' },
  { href: '/providers', label: 'Providers' },
  { href: '/guides', label: 'Guides' },
];

const currentPath = Astro.url.pathname;
---

<header class="sticky top-0 z-50 bg-white/95 backdrop-blur-sm border-b border-secondary-200">
  <div class="container-custom">
    <nav class="flex items-center justify-between h-16">
      <!-- Logo -->
      <a
        href="/"
        class="flex items-center gap-2 text-secondary-900 hover:text-primary-600 transition-colors min-h-[44px]"
      >
        <svg class="w-8 h-8" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle
            cx="16"
            cy="16"
            r="14"
            stroke="currentColor"
            stroke-width="2.5"
            class="text-primary-600"></circle>
          <circle cx="16" cy="16" r="6" fill="currentColor" class="text-primary-600"></circle>
          <path
            d="M16 2V8M16 24V30M2 16H8M24 16H30"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            class="text-primary-400"></path>
        </svg>
        <span class="text-xl font-bold">
          Proxy<span class="text-primary-600">FAQs</span>
        </span>
      </a>

      <!-- Desktop Navigation -->
      <div class="hidden md:flex items-center gap-1">
        {
          navLinks.map((link) => (
            <a
              href={link.href}
              class:list={[
                'px-4 py-3 min-h-[44px] rounded-lg text-sm font-medium transition-colors flex items-center',
                currentPath.startsWith(link.href)
                  ? 'bg-primary-50 text-primary-700'
                  : 'text-secondary-600 hover:text-secondary-900 hover:bg-secondary-50',
              ]}
            >
              {link.label}
            </a>
          ))
        }
      </div>

      <!-- Search & Mobile Menu -->
      <div class="flex items-center gap-2">
        <!-- Search Button -->
        <a
          href="/search"
          class="flex items-center justify-center gap-2 px-4 py-3 min-h-[44px] min-w-[44px] rounded-lg bg-secondary-100 text-secondary-500 hover:bg-secondary-200 transition-colors"
          aria-label="Search"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
          <span class="hidden sm:inline text-sm">Search...</span>
          <kbd
            class="hidden sm:inline px-1.5 py-0.5 text-xs bg-white rounded border border-secondary-300"
            >âŒ˜K</kbd
          >
        </a>

        <!-- Mobile Menu Button -->
        <button
          id="mobile-menu-btn"
          class="md:hidden p-3 min-h-[44px] min-w-[44px] rounded-lg hover:bg-secondary-100 transition-colors flex items-center justify-center"
          aria-label="Toggle menu"
          aria-expanded="false"
          aria-controls="mobile-menu"
        >
          <svg class="w-6 h-6 menu-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
          <svg
            class="w-6 h-6 close-icon hidden"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
    </nav>

    <!-- Mobile Navigation -->
    <div
      id="mobile-menu"
      class="hidden md:hidden pb-4"
      role="navigation"
      aria-label="Mobile navigation"
    >
      <div class="flex flex-col gap-1">
        {
          navLinks.map((link) => (
            <a
              href={link.href}
              class:list={[
                'px-4 py-3.5 min-h-[48px] rounded-lg text-sm font-medium transition-colors flex items-center',
                currentPath.startsWith(link.href)
                  ? 'bg-primary-50 text-primary-700'
                  : 'text-secondary-600 hover:text-secondary-900 hover:bg-secondary-50',
              ]}
            >
              {link.label}
            </a>
          ))
        }
      </div>
    </div>

    <!-- Mobile Bottom Navigation (for quick access) -->
    <div
      class="md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-secondary-200 z-50 safe-area-bottom"
    >
      <div class="flex items-center justify-around py-2">
        <a
          href="/q"
          class:list={[
            'flex flex-col items-center gap-1 px-4 py-2 min-w-[64px] min-h-[48px] rounded-lg transition-colors',
            currentPath.startsWith('/q')
              ? 'text-primary-600'
              : 'text-secondary-500 hover:text-secondary-900',
          ]}
        >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
            ></path>
          </svg>
          <span class="text-xs font-medium">Questions</span>
        </a>
        <a
          href="/category"
          class:list={[
            'flex flex-col items-center gap-1 px-4 py-2 min-w-[64px] min-h-[48px] rounded-lg transition-colors',
            currentPath.startsWith('/category')
              ? 'text-primary-600'
              : 'text-secondary-500 hover:text-secondary-900',
          ]}
        >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"
            ></path>
          </svg>
          <span class="text-xs font-medium">Categories</span>
        </a>
        <a
          href="/search"
          class:list={[
            'flex flex-col items-center gap-1 px-4 py-2 min-w-[64px] min-h-[48px] rounded-lg transition-colors',
            currentPath.startsWith('/search')
              ? 'text-primary-600'
              : 'text-secondary-500 hover:text-secondary-900',
          ]}
        >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
          <span class="text-xs font-medium">Search</span>
        </a>
        <a
          href="/providers"
          class:list={[
            'flex flex-col items-center gap-1 px-4 py-2 min-w-[64px] min-h-[48px] rounded-lg transition-colors',
            currentPath.startsWith('/providers')
              ? 'text-primary-600'
              : 'text-secondary-500 hover:text-secondary-900',
          ]}
        >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"
            ></path>
          </svg>
          <span class="text-xs font-medium">Providers</span>
        </a>
      </div>
    </div>
  </div>
</header>

<style>
  @supports (padding-bottom: env(safe-area-inset-bottom)) {
    .safe-area-bottom {
      padding-bottom: calc(0.5rem + env(safe-area-inset-bottom));
    }
  }
</style>

<script>
  const menuBtn = document.getElementById('mobile-menu-btn');
  const mobileMenu = document.getElementById('mobile-menu');
  const menuIcon = menuBtn?.querySelector('.menu-icon');
  const closeIcon = menuBtn?.querySelector('.close-icon');

  menuBtn?.addEventListener('click', () => {
    const isExpanded = menuBtn.getAttribute('aria-expanded') === 'true';
    menuBtn.setAttribute('aria-expanded', (!isExpanded).toString());
    mobileMenu?.classList.toggle('hidden');
    menuIcon?.classList.toggle('hidden');
    closeIcon?.classList.toggle('hidden');

    // Prevent body scroll when menu is open
    if (!isExpanded) {
      document.body.style.overflow = 'hidden';
    } else {
      document.body.style.overflow = '';
    }
  });

  // Close mobile menu when clicking on a link
  mobileMenu?.querySelectorAll('a').forEach((link) => {
    link.addEventListener('click', () => {
      if (menuBtn && mobileMenu) {
        menuBtn.setAttribute('aria-expanded', 'false');
        mobileMenu.classList.add('hidden');
        menuIcon?.classList.remove('hidden');
        closeIcon?.classList.add('hidden');
        document.body.style.overflow = '';
      }
    });
  });

  // Close mobile menu on escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && menuBtn?.getAttribute('aria-expanded') === 'true') {
      menuBtn.click();
    }
  });

  // Keyboard shortcut for search
  document.addEventListener('keydown', (e) => {
    if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
      e.preventDefault();
      window.location.href = '/search';
    }
  });

  // Add bottom padding to body on mobile for bottom nav
  function adjustBodyPadding() {
    const bottomNav = document.querySelector('[class*="fixed bottom-0"]');
    const body = document.body;
    if (window.innerWidth < 768 && bottomNav) {
      const navHeight = bottomNav.getBoundingClientRect().height;
      body.style.paddingBottom = `${navHeight}px`;
    } else {
      body.style.paddingBottom = '';
    }
  }

  window.addEventListener('resize', adjustBodyPadding);
  window.addEventListener('load', adjustBodyPadding);
</script>
